\section{Domain Interpretation}

After we compute the probabilities from the classification section, we need to produce a final interpretation of the graph in terms of edges, vertices, arrows, self-loops, connections between edges and vertices and connections between arrows and edges. To do this we cannot use the trivial method of partitioning the graph into segments (from our segmentation step) and  simply solving for the partition that produces the largest sum of classification probabilities (from the classification step). This is mainly because there is significant interaction between components of a graph. The design that we follow rests on the idea that the connections between the components influence the selection of the best interpretation.\\

We found it useful to rank candidate graphs by scores that are formed from a range of metrics like classifier probabilities (g(p)), total number of components (C(p)), number of connections (D(p)) and number of missing connections (M(p)). Thus, the score is simply: $V_{A,B,C}(p) = g(p) + A.C(p) + B.D(p) + C.M(p)$ where $g(p) = \sum_{(a_i,b_i,c_i) \in p}f(a_i+b_i+t_i)$. The function f is determined by the  classification probabilities. The score however is 0 when any component in p has a probability less 0.2. To properly asses the connections, we had to establish a set of machine specifications for our components where we could find the distances, say, between an edge and vertex or an edge an arrow.\\

\subsection{Algorithms}

The algorithm section can be divided into 2 parts: 1) domain interpretation and 2) training the score parameters.\\

\subsubsection{Connections}

A vertex-edge connection is tested for every vertex and edge pair. We can use the center and radius of the vertex to find the distance from the endpoints of the edge as edges are given as a set of target points that represent a smooth line. Computing the Euclidean distance between the center and each of the two endpoints of the edges gives us an idea of whether the connection is plausible. Of course, we have to subtract the radius of the circle itself and threshold the resulting distance to discard the large distance values. We maintain a score q for each edge end point that is initialized to infinity and updated if and only if a new vertex is found for the end point such that it's distance falls below the threshold and it is less than the previous q (negative values are clipped to 0).\\

The arrow-edge connection algorithm is more complex because it involve triangles (machine specification for arrows) and lines (edges) that have to intersect one of the sides of the triangle. Again, connection is tested for every arrow and edge pair (from the endpoints of the edge). Here, we first extend the edge sequence by adding a target point before the end point such that smoothness is still maintained (use the slope for this). The distance between the new and the old point is $\gamma$ . Now, we test for the segment between each consecutive pair of the extended edge. If the segment intersects with a side of the triangle, then two conditions have to satisfied. The first is that the distance between the endpoint and the point of intersection has to be under the threshold or the distance between the endpoint and the point opposite to the intersection side of the triangle has to be under the threshold. The second condition is valid only for arrows that were initially two-sided. It states that the side involved in the intersection is the same as the one that was initially non-represented by the user's drawing.\\

\subsubsection{Training the parameters}

Training is done by post-processing the sketches of users. Since we are implementing the online method now, our recognition is triggered a fixed time after the user stops sketching. We do not want the already graph to change. Hence, the "locked-in" portion of the graph doesn't change here. New connections are made between the newly drawn components and the locked in components by a recognizer. The recognizer maintains a sequence of added strokes and the corresponding sub-graphs. For every pair, we select the most promising candidate graph according to our scores. However, if an isomorph exists, we select the isomorph as the representation of the intermediate subgraph. If there exists no isomorphism then we penalize all the remaining pairs of new strokes and subgraphs.\\

\section{Future Work}
For segmentation, the immediate next step is to integrate the segmentation module with the classification module and fine tune the four hyperparameters discussed in this section. In addition, we will work on extending the algorithm to support offline graph recognition.\\


For classification, our future work is to connect the probability distributions computed in this step to the domain interpretation step. Certain classes tend to have similar probabilities, for example, vertices and self-loops are difficult to differentiate. These are typically differentiated in domain interpretation rather than classification. In addition, we may need to further test these implementations on more data, or train more on our own data so that our weights better reflect our specific implementations.\\

For domain interpretation, we are still in the process of developing the training algorithm. We are currently working on how to decide on a list of candidate graphs. One option is to use close component classification probabilities to create a set of plausible graphs. Our algorithm to find the isomorphism and line-triangle intersection still need testing. The other functions have been tested on dummy probabilities. However, we still are yet to integrate the segmentation and classification sections to this section, which is why this section has not yet been tested on real examples yet.\\

After successfully completing the online method, we will work on the offline method. There are some fundamentally different aspects to the offline method like the recognizer will only act on the graph after completion and connections do not have to maintained to a locked-in graph. We aim to have an effective offline interpretation as our ambitious goal.\\